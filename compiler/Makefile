OCAMLC=ocamlc
OCAMLDEP=ocamldep
OCAMLLEX=ocamllex
OCAMLYACC=ocamlyacc
OBJS=ast.cmo parser.cmo scanner.cmo environment.cmo semantic.cmo compile.cmo ql.cmo

ql: $(OBJS)
	ocamlc -o ql $(OBJS)

scanner.ml: scanner.mll
	$(OCAMLLEX) scanner.mll

parser.ml parser.mli: parser.mly
	$(OCAMLYACC) parser.mly

%.cmo : %.ml
	ocamlc -c $<

%.cmi : %.mli
	ocamlc -c $<

.PHONY: clean
clean:
	rm -rf scanner.ml parser.ml parser.mli *.cmo *.cmi *.out *.diff ql

# Generated by ocamldep
# TODO: Make this generate our actual dependencies
ast.cmo :
ast.cmx :
environment.cmo : ast.cmo
environment.cmx : ast.cmx
semantic.cmo : environment.cmo ast.cmo
semantic.cmx : environment.cmx ast.cmx
compile.cmo : ast.cmo
compile.cmx : ast.cmx
sast.cmo : ast.cmo
sast.cmx : ast.cmx
parser.cmo : ast.cmo parser.cmi
parser.cmx : ast.cmx parser.cmi
ql.cmo : scanner.cmo parser.cmi ast.cmo semantic.cmo compile.cmo
ql.cmx : scanner.cmx parser.cmx ast.cmx semantic.cmx compile.cmx
scanner.cmo : parser.cmi
scanner.cmx : parser.cmx
parser.cmi : ast.cmo
